{% extends "base.html" %}

{% import 'macros/gallery.html' as gallery_macros %}
{% import 'macros/sections.html' as section_macros %}

{% block header_class %}header--transparent{% endblock %}

{% block title_entire %}{{ config.site_name }}{% endblock %}

{% block meta %}
  <meta property="og:image" content="https://hp.lewiscollard.com/resource/images/opengraph/vaskelis.jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="631" />
  <meta property="og:title" content="Horsepower" />
  <meta property="og:description" content="A motorsports gallery by Lewis Collard." />
{% endblock %}

{% block content %}
  <article class="front-page">
    <header class="hero hero--loading" id="front-page-hero">
      <div class="hero__image"></div>
      <div class="hero__loader"></div>
      <div class="hero__content contained">
        <h1 class="hero__title">
          <span class="hero__title-top">
            Motorsports photography by
          </span>

          <span class="hero__title-bottom">
            Lewis Collard
          </span>
        </h1>
      </div>

      <div class="hero__spinner">
        {% include 'svg/spinner.svg' %}
      </div>

      <span class="hero__indicator">
        {% include 'svg/chevron.svg' %}
      </span>
    </header>

    <script>
      (function () {
        var images = [
          '/resource/images/heroes/haddon.jpg',
          '/resource/images/heroes/simmons.jpg',
        ]
        var image = images[Math.floor(images.length * Math.random())];
        var hero = document.querySelector('.hero')
        var heroImage = document.querySelector('.hero__image');
        var imgtag = new Image();
        imgtag.onload = function() {
          hero.classList.remove('hero--loading');
          heroImage.style.backgroundImage = "url('" + image + "')";
        }
        setTimeout(function () {
          imgtag.src = image
        }, 1)
      })();
    </script>

    {% call section_macros.generic(kicker='About', title='Behind the lens', link='/about/', link_text='More about me') %}
      <div class="section__text plain-text constrained">
        <p>I'm Lewis Collard. I am a photographer with the Norfolk Arena Drift Team,
        the greatest grass-roots drift racing crew on the planet,
        though there are allegations that I have occasionally
        <a href="/galleries/events/2014-04-15-rwyb-santa-pod-raceway-april-2014/">shot
        things driving in a straight line</a> and even cars
        <a href="/galleries/drivers/darren-brown/b3253b-20160730-run-the-darren-brown-DSC_0485/">not
        moving at all.</a></p>

        <p>This site is the result of thousands of hours of work. I hope you
        enjoy it as much as I enjoyed making it.</p>
      </div>

      <div class="section__extra constrained">
        {{ section_macros.stats([
          {'number': event_count, 'text': 'events attended'},
          {'number': driver_count, 'text': 'drivers photographed'},
          {'number': "{:,}".format(photo_count), 'text': 'high resolution downloads'},
        ]) }}
      </div>
    {% endcall %}

    {% for tax in taxonomies %}
      {% if tax.name in ["Events", "Drivers"] %}
        <section class="gallery-section {% if loop.index % 2 == 0 %}gallery-section-altLayout{% endif %}" id="{{tax.slug}}">
          <div class="gallery-section-text">
            <div class="gallery-section-text-inner">
              <h2 class="gallery-section-text-title">{{ tax.name }}</h2>
              <p class="gallery-section-text-subtitle">
                {% if tax.name == "Drivers" %}
                  Mad skills.<br />Unique styles.
                {% elif tax.name == "Events" %}
                  The action.<br />Up close.
                {% endif %}
              </p>
              <p class="gallery-section-text-action-outer">
                <a href="{{ tax.index_url }}" class="button onDark gallery-section-text-button">View all</a>
              </p>
            </div>
          </div>

          <ul class="gallery-section-items album-listing-{{tax.slug}} gallery-section-items-{{ tax.slug }}">
            {% for gallery in tax.galleries %}
              <li class="gallery-item gallery-section-item-longerDesc gallery-section-item-{{ tax.name.lower() }} gallery-section-item has-caption scroll-bling">
                {{ gallery_macros.tile(
                  image=gallery.get_cover().get_size('thumb').get_url(),
                  link_url=gallery.get_url(),
                  title=gallery.title,
                  count=gallery.count(),
                ) }}
              </li>
            {% endfor %}
          </ul>
        </section>

        {% if tax.name == "Events" %}
          <div class="fullscreen">
            <div class="fullscreen__image" style="background-image: url(/resource/images/fullscreen/ross/DSC_2170-1920.JPG)"></div>
          </div>

        {% elif tax.name == "Drivers" %}
          <div class="fullscreen fullscreen-2">
            <div class="fullscreen__image" style="background-image: url(/resource/images/fullscreen/ash/DSC_0020-1920.JPG)"></div>
          </div>
        {% endif %}
      {% elif tax.name == "Teams" %}
        {% call section_macros.generic(kicker=tax.name, title='Speed. Angle. Showmanship.', link=tax.index_url, link_text='View all teams') %}
          <div class="section__extra">
            <ul class="team-list">
              {% for gallery in tax.galleries[:3] %}
                <li class="team-list__item">
                  <a class="team-list__item-action" href="{{ gallery.get_url() }}">
                    <span class="team-list__item-image">
                      {% if gallery.metadata["Transparent image"] %}
                        <img aria-hidden="true" src='{{ gallery.metadata["Transparent image"] }}' alt="" />
                      {% else %}
                        <span class="team-list__item-image-placeholder"></span>
                      {% endif %}
                    </span>
                    <span class="team-list__item-text">
                      {{ gallery.title }}
                    </span>
                  </a>
                </li>
              {% endfor %}
            </ul>
          </div>
        {% endcall %}
      {% endif %}
    {% endfor %}

    <section class="gallery-section {% if loop.index % 2 == 0 %}gallery-section-altLayout{% endif %}" id="awesome">
      <div class="gallery-section-text">
        <div class="gallery-section-text-inner">
          <h2 class="gallery-section-text-title">Greatest hits</h2>
          <p class="gallery-section-text-subtitle">
            The best of the best.
          </p>
          <p class="gallery-section-text-action-outer">
            <a href="{{ awesome.get_url() }}" class="button onDark gallery-section-text-button">View all</a>
          </p>
        </div>
      </div>

      <ul class="gallery-section-items album-listing-awesome">
        {% for image in awesome.pictures[0:9] %}
          <li class="gallery-item gallery-section-item has-caption">
            <div class="gallery-section-item-inner">
              {{ gallery_macros.tile(
                image=image.get_size('thumb').get_url(),
                link_url='/galleries/awesome/awesome/{}/'.format(image.identifier),
                indicator_type='glass'
              ) }}
            </div>
          </li>
        {% endfor %}
      </ul>
    </section>

    {% include 'includes/upcoming-events.html' %}

    <section class="contact-section">
      <div class="contained">
        <h2 class="contact-section__title">Contact me</h2>

        <p class="contact-section__subtitle">Got questions?</o>

          <div class="plain-text contact-section__text">
            <p>Think you should be here, and you're not? Want me at your event? Spotted an error?</p>
          </div>

          <p class="contact-section__action-outer">
            <a class="button onDark" href="/contact/">Get in touch</a>
          </p>
        </h2>
      </div>
    </section>
  </article>
{% endblock %}
